%% APPENDIX B %%
\vspace{-10mm}
\chapter{Fixed-Base Leg Dynamics}
\label{appendix::b}
	\vspace{-5mm}


	\subsubsection{Dynamics of Leg \emph{i}}

	The dynamics of each \Ith leg (represented as a fixed-base kinematic chain) are described as follows:	
		\begin{equation*}
			\tau_{i} = M(q_{i})\ddot{q}_{i} + C(q_{i},\dot{q}_{i})\dot{q}_{i} + G(q_{i},\vec{g})
		\end{equation*}
	where $M(q_{i})$ represents the mass matrix; $C(q_{i},\dot{q}_{i})$ represents the Coriolis matrix; $G(q_{i},\vec{g})$ represents the gravity matrix; and $\tau_{i}\in\RRe^{4}$ represents a generalized torque input. %$M(q_{i})$, $C(q_{i},\dot{q}_{i})$  and  $G(q_{i},\vec{g})$ are defined explicitly in the sections to follow.

	\subsubsection{Mass Matrix, $M\wrap{q_{i}}$}
	\vspace{-5mm}
	{
	\begin{equation*}
		\begin{split}\small
		M_{11}  & = m_{i,1} + m_{i,2} + m_{i,3} + m_{i,4} + (m_{i,4} s_{i,1}^2 (2 a_{1} + 2 a_{3} c_{i,23} + 2 a_{2} c_{i,2} + a_{4} c_{i,234})^2)/4 \\
				& + (m_{i,3} c_{1}^2 (2 a_{1} + a_{3} c_{i,23} + 2 a_{2} c_{i,2})^2)/4 \\ 
				& + (m_{i,3} s_{i,1}^2 (2 a_{1} + a_{3} c_{i,23} + 2 a_{2} c_{i,2})^2)/4 \\
				& + (a_{1}^2 m_{i,1} c_{1}^2)/4 + (a_{1}^2 m_{i,1} s_{i,1}^2)/4  \\
				& + (m_{i,2} c_{1}^2 (2 a_{1} + a_{2} c_{i,2})^2)/4 + (m_{i,2} s_{i,1}^2 (2 a_{1} + a_{2} c_{i,2})^2)/4 \\
				& + (m_{i,4} c_{1}^2 (2 a_{1} + 2 a_{3} c_{i,23} + 2 a_{2} c_{i,2} + a_{4} c_{i,234})^2)/4 \\
		M_{22}  & = m_{i,2} + m_{i,3} + m_{i,4} + (a_{2}^2 m_{i,2})/4 + a_{2}^2 m_{i,3} + a_{2}^2 m_{i,4} \\
				& + (a_{3}^2 m_{i,3})/4 + a_{3}^2 m_{i,4} + (a_{4}^2 m_{i,4})/4 + a_{2} a_{4} m_{i,4} c_{i,34} + a_{2} a_{3} m_{i,3} c_{i,3} \\
				& + 2 a_{2} a_{3} m_{i,4} c_{i,3} + a_{3} a_{4} m_{i,4} c_{i,4}\\
		M_{33}  & = m_{i,3} + m_{i,4} + (a_{3}^2 m_{i,3})/4 + a_{3}^2 m_{i,4} + (a_{4}^2 m_{i,4})/4 + a_{3} a_{4} m_{i,4} c_{i,4}\\
		M_{44}  & = (m_{i,4} (a_{4}^2 + 4))/4\\
		M_{23}  & = M_{32} = m_{i,3} + m_{i,4} + (a_{3}^2 m_{i,3})/4 + a_{3}^2 m_{i,4} + (a_{4}^2 m_{i,4})/4 + (a_{2} a_{4} m_{i,4} c_{i,34})/2 \\
				& + (a_{2} a_{3} m_{i,3} c_{i,3})/2 + a_{2} a_{3} m_{i,4} c_{i,3} + a_{3} a_{4} m_{i,4} c_{i,4} \\
		M_{24}  & = M_{42} = (m_{i,4} (a_{4}^2 + 2 a_{2} a_{4} c_{i,34} + 2 a_{3} a_{4} c_{i,4} + 4))/4\\
		M_{34} 	& = M_{43} = (m_{i,4} (a_{4}^2 + 2 a_{3} c_{i,4} a_{4} + 4))/4\\
		M_{12}  & = M_{21} = M_{13}  = M_{31} = M_{14} = M_{41} = 0\\
		\end{split}
	\end{equation*}
	}

	\subsubsection{Coriolis Matrix, $C\wrap{q_{i},\dot{q}_{i}}$}
	\label{sec::Coriolis_matrix}
	\vspace{-5mm}
	\begin{equation*}\small
		\begin{split} 
		C_{11} 	& = -\dot{q}_{i,3} ((m_{i,4} c_{1}^2 (2 a_{3} s_{i,23} + a_{4} s_{i,234}) (2 a_{1} + 2 a_{3} c_{i,23} + 2 a_{2} c_{i,2} + a_{4} c_{i,234}))/2\\ 
				& + (m_{i,4} s_{i,1}^2 (2 a_{3} s_{i,23} + a_{4} s_{i,234}) (2 a_{1} + 2 a_{3} c_{i,23} + 2 a_{2} c_{i,2} + a_{4} c_{i,234}))/2 \\
				& + (a_{3} m_{i,3} s_{i,23} c_{1}^2 (2 a_{1} + a_{3} c_{i,23} + 2 a_{2} c_{i,2}))/2 + (a_{3} m_{i,3} s_{i,23} s_{i,1}^2 (2 a_{1} + a_{3} c_{i,23} + 2 a_{2} c_{i,2}))/2) \\
				& - \dot{q}_{i,2} ((a_{2}^2 m_{i,2} s_{i,2.2})/4 + a_{2}^2 m_{i,3} s_{i,2.2} + a_{2}^2 m_{i,4} s_{i,2.2} + (a_{4}^2 m_{i,4} S_{2.2(34)})/4 + (a_{3}^2 m_{i,3} s_{i,2.23})/4 \\
				& + a_{3}^2 m_{i,4} s_{i,2.23} + a_{1} a_{3} m_{i,3} s_{i,23} + 2 a_{1} a_{3} m_{i,4} s_{i,23} + a_{1} a_{2} m_{i,2} s_{i,2} + 2 a_{1} a_{2} m_{i,3} s_{i,2} + 2 a_{1} a_{2} m_{i,4} s_{i,2} \\
				& + a_{3} a_{4} m_{i,4} s_{i,2.2(34)} + a_{2} a_{3} m_{i,3} s_{i,2.23} + 2 a_{2} a_{3} m_{i,4} s_{i,2.23} + a_{1} a_{4} m_{i,4} s_{i,234} + a_{2} a_{4} m_{i,4} s_{2.2(34)}) \\
				& - (a_{4} m_{i,4} s_{i,234} \dot{q}_{i,4} (2 a_{1} + 2 a_{3} c_{i,23} + 2 a_{2} c_{i,2} + a_{4} c_{i,234}))/2\\
	 	C_{12} 	& = -\dot{q}_{i,1} ((a_{2}^2 m_{i,2} s_{i,2.2})/4 + a_{2}^2 m_{i,3} s_{i,2.2} + a_{2}^2 m_{i,4} s_{i,2.2} + (a_{4}^2 m_{i,4} S_{2.2(34)})/4 + (a_{3}^2 m_{i,3} s_{i,2.23})/4 \\
	 			& + a_{3}^2 m_{i,4} s_{i,2.23} + a_{1} a_{3} m_{i,3} s_{i,23} + 2 a_{1} a_{3} m_{i,4} s_{i,23} + a_{1} a_{2} m_{i,2} s_{i,2} + 2 a_{1} a_{2} m_{i,3} s_{i,2} + 2 a_{1} a_{2} m_{i,4} s_{i,2} \\
	 			& + a_{3} a_{4} m_{i,4} s_{i,2.2(34)} + a_{2} a_{3} m_{i,3} s_{i,2.23} + 2 a_{2} a_{3} m_{i,4} s_{i,2.23} + a_{1} a_{4} m_{i,4} s_{i,234} + a_{2} a_{4} m_{i,4} s_{2.2(34)})\\
	 	C_{13} 	& = -\dot{q}_{i,1} ((m_{i,4} c_{1}^2 (2 a_{3} s_{i,23} + a_{4} s_{i,234}) (2 a_{1} + 2 a_{3} c_{i,23} + 2 a_{2} c_{i,2} + a_{4} c_{i,234}))/2 \\
	 			& + (m_{i,4} s_{i,1}^2 (2 a_{3} s_{i,23} + a_{4} s_{i,234}) (2 a_{1} + 2 a_{3} c_{i,23} + 2 a_{2} c_{i,2} + a_{4} c_{i,234}))/2 \\
	 			& + (a_{3} m_{i,3} s_{i,23} c_{1}^2 (2 a_{1} + a_{3} c_{i,23} + 2 a_{2} c_{i,2}))/2 + (a_{3} m_{i,3} s_{i,23} s_{i,1}^2 (2 a_{1} + a_{3} c_{i,23} + 2 a_{2} c_{i,2}))/2)\\
	 	C_{14} 	& = -(a_{4} m_{i,4} s_{i,234} \dot{q}_{i,1} (2 a_{1} + 2 a_{3} c_{i,23} + 2 a_{2} c_{i,2} + a_{4} c_{i,234}))/2\\
		C_{21} 	& = \dot{q}_{i,1} ((a_{2}^2 m_{i,2} s_{i,2.2})/4 + a_{2}^2 m_{i,3} s_{i,2.2} + a_{2}^2 m_{i,4} s_{i,2.2} \\
				& + (a_{4}^2 m_{i,4} S_{2.2(34)})/4 + (a_{3}^2 m_{i,3} s_{i,2.23})/4 + a_{3}^2 m_{i,4} s_{i,2.23} \\
				& + a_{1} a_{3} m_{i,3} s_{i,23} + 2 a_{1} a_{3} m_{i,4} s_{i,23} + a_{1} a_{2} m_{i,2} s_{i,2} + 2 a_{1} a_{2} m_{i,3} s_{i,2} \\
				& + 2 a_{1} a_{2} m_{i,4} s_{i,2} + a_{3} a_{4} m_{i,4} s_{i,2.2(34)} + a_{2} a_{3} m_{i,3} s_{i,2.23} + 2 a_{2} a_{3} m_{i,4} s_{i,2.23} \\
				& + a_{1} a_{4} m_{i,4} s_{i,234} + a_{2} a_{4} m_{i,4} s_{2.2(34)})\\
	   	C_{22} 	& = -a_{2} \dot{q}_{i,3} (a_{4} m_{i,4} S_{34} + a_{3} m_{i,3} s_{i,3} + 2 a_{3} m_{i,4} s_{i,3}) - a_{4} m_{i,4} (a_{2} S_{34} + a_{3} s_{i,4}) \dot{q}_{i,4}\\
	   	C_{23} 	& = -a_{2} \dot{q}_{i,2} (a_{4} m_{i,4} S_{34} + a_{3} m_{i,3} s_{i,3} + 2 a_{3} m_{i,4} s_{i,3}) - a_{2} \dot{q}_{i,3} (a_{4} m_{i,4} S_{34} + a_{3} m_{i,3} s_{i,3} \\
	   			& + 2 a_{3} m_{i,4} s_{i,3}) - a_{4} m_{i,4} (a_{2} S_{34} + a_{3} s_{i,4}) \dot{q}_{i,4}\\
	    C_{24} 	& = -a_{4} m_{i,4} (a_{2} S_{34} + a_{3} s_{i,4}) (\dot{q}_{i,2} + \dot{q}_{i,3} + \dot{q}_{i,4})\\
	 	C_{31} 	& = \dot{q}_{i,1} ((m_{i,4} c_{1}^2 (2 a_{3} s_{i,23} + a_{4} s_{i,234}) (2 a_{1} + 2 a_{3} c_{i,23} + 2 a_{2} c_{i,2} + a_{4} c_{i,234}))/2 \\
	 			& + (m_{i,4} s_{i,1}^2 (2 a_{3} s_{i,23} + a_{4} s_{i,234}) (2 a_{1} + 2 a_{3} c_{i,23} + 2 a_{2} c_{i,2} + a_{4} c_{i,234}))/2 \\
	 			& + (a_{3} m_{i,3} s_{i,23} c_{1}^2 (2 a_{1} + a_{3} c_{i,23} + 2 a_{2} c_{i,2}))/2 + (a_{3} m_{i,3} s_{i,23} s_{i,1}^2 (2 a_{1} + a_{3} c_{i,23} + 2 a_{2} c_{i,2}))/2)\\
	    C_{32} 	& = a_{2} \dot{q}_{i,2} (a_{4} m_{i,4} S_{34} + a_{3} m_{i,3} s_{i,3} + 2 a_{3} m_{i,4} s_{i,3}) - a_{3} a_{4} m_{i,4} s_{i,4} \dot{q}_{i,4}\\
	   	C_{33} 	& =  -a_{3} a_{4} m_{i,4} s_{i,4} \dot{q}_{i,4}\\
	    C_{34} 	& = -a_{3} a_{4} m_{i,4} s_{i,4} (\dot{q}_{i,2} + \dot{q}_{i,3} + \dot{q}_{i,4})\\
	    C_{41} 	& = (a_{4} m_{4} s_{i,234} \dot{q}_{i,1} (2 a_{1} + 2 a_{3} c_{i,23} + 2 a_{2} c_{i,2} + a_{4} c_{i,234}))/2\\
	    C_{42} 	& = a_{4} m_{4} (a_{2} s_{i,34} + a_{3} s_{i,4}) \dot{q}_{i,2} + a_{3} a_{4} m_{4} s_{i,4} \dot{q}_{i,3}\\
	    C_{43} 	& = a_{3} a_{4} m_{4} s_{i,4} (\dot{q}_{i,2} + \dot{q}_{i,3})\\
	    C_{44} 	& = 0
		\end{split}
	\end{equation*}

	\subsubsection{Gravity Matrix, $G\wrap{q_{i},\vec{g}}$}
	\label{sec::gravity_matrix}
	\vspace{-5mm}
	\begin{equation*}\small
		\begin{split}
		G_{1}  &=  \norm{\vec{g}} m_{i,1} (a_{1} (\vec{g}_{y}) c_{1} - a_{1} (\vec{g}_{x}) s_{i,1}) \\
		G_{2}  &= -\norm{\vec{g}} m_{i,2} (a_{2} (\vec{g}_{x}) c_{1} s_{i,2} - a_{2} c_{i,2} (\vec{g}_{z}) + a_{2} (\vec{g}_{y}) s_{i,1} s_{i,2}) \\
		G_{3}  &= -\norm{\vec{g}} m_{i,3} (a_{3} s_{i,23} (\vec{g}_{y}) s_{i,1} - a_{3} c_{i,23} (\vec{g}_{z}) + a_{3} s_{i,23} (\vec{g}_{x}) c_{1}) \\
		G_{4}  &= -\norm{\vec{g}} m_{i,4} (a_{4} s_{i,234} (\vec{g}_{x}) c_{1} - a_{4} c_{i,234} (\vec{g}_{z}) + a_{4} s_{i,234} (\vec{g}_{y}) s_{i,1})
		\end{split}
	\end{equation*}
	with $\vec{g} = [\vec{g}_{x},\vec{g}_{y},\vec{g}_{z}]^{T} \in \Re^{3}$ being a gravity vector pointing relative to the base-frame $O_{i,0}$.

	%\vspace{10mm}
	%\noindent
	%\emph{See Appendix~\ref{appendix::e} for a summary of abreviations.}